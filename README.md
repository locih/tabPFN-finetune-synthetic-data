# TabPFN Finetuning with Synthetic Data

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥–µ TabPFN –º–æ–¥–µ–ª–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tabPFN-finetune-synthetic-data/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–¥–∞—Ç–∞—Å–µ—Ç—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—É—Ç–∏)
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data_utils.py       # –£—Ç–∏–ª–∏—Ç—ã: –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –º–µ—Ç—Ä–∏–∫–∏, –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ generators/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ synthetic.py        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ experiments/
‚îÇ   ‚îú‚îÄ‚îÄ 01_baseline.py          # –ë–∞–∑–æ–≤–∞—è –ª–∏–Ω–∏—è (–±–µ–∑ —Å–∏–Ω—Ç–µ—Ç–∏–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ 02_mixed_model.py       # BGM + Classifier –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ 03_gmm.py               # Gaussian Mixture Model –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ README.md               # –û–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ results/                    # CSV —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ models/                     # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ note.ipynb                  # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ (–∞—Ä—Ö–∏–≤)
‚îî‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

**–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:**
```bash
python run_all_experiments.py
```

**–ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã:**

```bash
# –±–µ–∑ —Ñ–∞–π–Ω—Ç—é–Ω–∞
python experiments/01_baseline.py

# –û–±—ã—á–Ω—ã–π —Ñ–∞–π–Ω—Ç—é–Ω (–±–µ–∑ —Å–∏–Ω—Ç–µ—Ç–∏–∫–∏)
python experiments/02_finetuning.py

# TableAugmentation (—Å–ª—É—á–∞–π–Ω–æ–µ –≤—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
python experiments/04_tableaugmentation.py

# –°–º–µ—à–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–≥–∏–±–∫–∏–π —Ä–∞–∑–º–µ—Ä)
python experiments/03_mixed_model.py

# –°–º–µ—à–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ 5000)
python experiments/05_mixed_model_5k.py

# Gaussian Mixture Model
python experiments/06_gmm.py

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä–∞–∑–º–µ—Ä–∞)
python experiments/07_scaling_experiment.py

# SDV –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
python experiments/08_sdv_generators.py tvae      # –∏–ª–∏ ctgan, copula
```

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV:
- `baseline_results_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏
- `finetuning_results_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥–∞ –±–µ–∑ —Å–∏–Ω—Ç–µ—Ç–∏–∫–∏
- `tableaugmentation_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã TableAugmentation
- `mixed_model_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (–≥–∏–±–∫–∏–π —Ä–∞–∑–º–µ—Ä)
- `mixed_model_5k_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (5000 –æ–±—Ä–∞–∑—Ü–æ–≤)
- `gmm_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã GMM
- `scaling_experiment_final.csv` - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `sdv_tvae_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã TVAE –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- `sdv_ctgan_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã CTGAN –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
- `sdv_copula_final.csv` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Gaussian Copula

## üìä –î–∞–Ω–Ω—ã–µ

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã OpenML:**
- Dataset ID 31 (Iris)
- Dataset ID 37 (Letter)
- Dataset ID 46 (Waveform)
- Dataset ID 1464 (Higgs)
- Dataset ID 40701 (PhishingWebsites)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑–±–∏–µ–Ω–∏—è:**
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: 60%
- –í–∞–ª–∏–¥–∞—Ü–∏—è: 20%
- –¢–µ—Å—Ç: 20%

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `src/config/config.py`:

```python
# –î–∞—Ç–∞—Å–µ—Ç—ã –∏ seeds
DATASET_IDS = [31, 37, 46, 1464, 40701]
SEEDS = [0, 1, 2, 3, 4]

# –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
OVERALL_TIME_LIMIT = 4 * 3600  # 4 —á–∞—Å–∞
PATIENCE = 10                   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –±–µ–∑ —É–ª—É—á—à–µ–Ω–∏—è

# TabPFN –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
TABPFN_CONFIG_FINETUNING = {
    "max_epochs": 30,
    "learning_rate": 1e-7,
    "batch_size": 4,
    ...
}
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è:
- **Log Loss** - –æ—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Accuracy** - –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **F1-weighted** - –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π F1 score
- **ROC-AUC** - –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC –∫—Ä–∏–≤–æ–π

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

### `src/utils/data_utils.py`
- `load_openml_dataset()` - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å OpenML
- `make_60_20_20_splits()` - –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ 60-20-20
- `compute_extended_metrics()` - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### `src/config/config.py`
–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

### `src/generators/synthetic.py`
- `MixedModelGenerator` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- `GMMGenerator` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ GMM

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

CSV —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

```
dataset_id          - ID –¥–∞—Ç–∞—Å–µ—Ç–∞ OpenML
seed                - Random seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
test_log_loss       - Log Loss –Ω–∞ —Ç–µ—Å—Ç–µ (–æ—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞)
test_accuracy       - Accuracy –Ω–∞ —Ç–µ—Å—Ç–µ
test_f1_weighted    - F1-weighted –Ω–∞ —Ç–µ—Å—Ç–µ
test_roc_auc        - ROC-AUC –Ω–∞ —Ç–µ—Å—Ç–µ
best_iter           - –ù–æ–º–µ—Ä –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Å –ª—É—á—à–µ–π –º–æ–¥–µ–ª—å—é
best_val_log_loss   - Log Loss –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
```

–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ 5 seeds –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞.